<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snap2Site</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        h1 {
            color: #ddd6d6;
            font-family: 'Courier New', Courier, monospace;
            letter-spacing: 5px;
        }

        .logo {
            position: relative;
            top: 20px;
            width: 200px;
            height: auto;
        }
        .outerbox {
            display: flex;
            flex-direction: row;
        }
        .box {
            width: 550px;
            height: 400px;
            background-color: #ddd6d6;
            display: flex;
            flex-direction: column;
            border: 1px solid black;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            border-style: double;
            font-family: 'Courier New', Courier;
            font-size: 20px;
            text-align: center;
            padding: 30px;
        }
        .box:first-child p{
            margin-top: 20px;
            text-align: left;
            font-size: 12px;
        }
        .box:first-child {
            display: block;
            padding: 0;
            height: 460px;
            width: 1100px;
            overflow: hidden;
        }
        .box iframe {
            width: 100%;
            height: 100%;
            display: block;
            transform-origin: top left;
            overflow-y: auto;
            border: none;
        }
        button {
            margin-top: 20px;
            width: 200px;
            height: auto;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', Courier;
            font-style: initial;
            font-size: 20px;
            border-style: double;
            cursor: pointer;
        }
    </style>
</head>
<body style="background-image: url('{{ url_for('static', filename='bg.jpg') }}');">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo">
    <h1>Snap2Site</h1>
    <div class="outerbox">
        <div class="box"> <!-- Preview -->
            <iframe id="myIframe" src="{{ url_for('uploads', filename='Initialresult.html') }}" frameborder="0"></iframe>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                var iframe = document.getElementById('myIframe');
                iframe.onload = function() {
                    var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    var originalWidth = iframeDoc.documentElement.scrollWidth || iframeDoc.body.scrollWidth;
                    var originalHeight = iframeDoc.documentElement.scrollHeight || iframeDoc.body.scrollHeight;
    
                    console.log('Original Width:', originalWidth);
                    console.log('Original Height:', originalHeight);
    
                    var scaleX = 1102 / originalWidth;
                    var scaleY = 462 / originalHeight;
                    var scale = Math.max(scaleX, scaleY);

                    console.log('Scale:', scale);
                    
                    // Adjust the height of the iframe based on its content
                    iframe.style.height = originalHeight * scale + 'px';
                    iframe.style.transform = 'scale(' + scale + ')';
                    iframe.style.width = originalWidth + 'px';
                };
            });
        </script>
        <div class="box"> <!-- Customization(Buttons // etc ) -->
            <h2>Color Scheme</h2>
            <label for="Header-color">Header Color</label>
            <select id="header-color">
                <option value="" disabled selected>choose Header Color</option>
                <option value="#AC92EB">Purple</option>
                <option value="#4FC1E8">Teal</option>
                <option value="#A0D568">Light Green</option>
                <option value="#FFCE54">Yellow</option>
                <option value="#ED5564">PINK RED</option>
                <!-- Add more-->
            </select>

            <label for="body-color">Body Color</label>
            <select id="body-color">
                <option value="" disabled selected>choose body Color</option>
                <option value="#AC92EB">Purple</option>
                <option value="#4FC1E8">Teal</option>
                <option value="#A0D568">Light Green</option>
                <option value="#FFCE54">Yellow</option>
                <option value="#ED5564">PINK RED</option>
                <!-- Add more-->
            </select>

            <label for="footer-color">Footer Color</label>
            <select id="footer-color">
                <option value="" disabled selected>choose footer color</option>
                <option value="#AC92EB">Purple</option>
                <option value="#4FC1E8">Teal</option>
                <option value="#A0D568">Light Green</option>
                <option value="#FFCE54">Yellow</option>
                <option value="#ED5564">PINK RED</option>
                <!-- Add more-->
            </select>

            <h2>Font Customization</h2>
            <label for="header-font">choose headers font</label>
            <select id="header-font">
                <option value="" disabled selected>choose headers font</option>
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
                <!-- Add more-->
            </select>

            <label for="body-font">choose main font</label>
            <select id="body-font">
                <option value="" disabled selected>choose headers font</option>
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
                <!-- Add more-->
            </select>

            <label for="footer-font">choose footer font</label>
            <select id="footer-font">
                <option value="" disabled selected>choose footer font</option>
                <option value="Arial">Arial</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
                <!-- Add more -->
            </select>

        </div>
    </div>
    <div class="outerbox">
        <button id='custButton' onclick="customize()">Customize</button>
        <button id='downloadbutt' onclick="downloadFile()">Download template</button>
    </div>
    
    <script>
        function customize() {
                console.log('Clicked');
                var headerFont = document.getElementById("header-font").value;
                var bodyFont = document.getElementById("body-font").value;
                var footerFont = document.getElementById("footer-font").value;
                var headercolor = document.getElementById("header-color").value;
                var bodycolor = document.getElementById("body-color").value;
                var footercolor = document.getElementById("footer-color").value;

                var iframe = document.getElementById('myIframe');

                // Access the document inside the iframe
                var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
                console.log(innerDoc)

                // Modify the styles in the document
                
                innerDoc.querySelector('body').style.fontFamily = bodyFont;
                innerDoc.querySelector('body').style.backgroundColor = bodycolor

                if (innerDoc.querySelector('header') != null && innerDoc.querySelector('header') != undefined){
                    innerDoc.querySelector('header').style.backgroundColor = headercolor
                    innerDoc.querySelector('header').style.fontFamily = headerFont;
                }
                if (innerDoc.querySelector('footer') != null && innerDoc.querySelector('footer') != undefined){
                    innerDoc.querySelector('footer').style.backgroundColor = footercolor
                    innerDoc.querySelector('footer').style.fontFamily = footerFont;
                }
                
                var iframe = document.getElementById('myIframe');
                var Content = iframe.contentDocument || iframe.contentWindow.document;
                var iframeContent = Content.documentElement.outerHTML;

                var htmlTextDiv = document.getElementById('htmlText');
                var result = iframeContent;
                if (htmlTextDiv) {
                    htmlTextDiv.innerHTML = ''; // Clear existing content
                    if (result) {
                        var paragraph = document.createElement('p');
                        paragraph.textContent = result;
                        htmlTextDiv.appendChild(paragraph);
                    }
                } else {
                    console.log("Div with id 'htmlText' not found.");
                }
            };
        function downloadFile() {
            var iframe = document.getElementById('myIframe');
            var Content = iframe.contentDocument || iframe.contentWindow.document;
            var iframeContent = Content.documentElement.outerHTML;
            var file = new File(["\ufeff"+iframeContent], 'Template.html', {type: "text/plain:charset=UTF-8"});
            url = window.URL.createObjectURL(file);

            var a = document.createElement("a");
            a.style = "display: none";
            a.href = url;
            a.download = file.name;
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>         
</body>
</html>
